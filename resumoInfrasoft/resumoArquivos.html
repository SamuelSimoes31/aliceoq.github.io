<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Sistemas de arquivos</title>
    </head>
    <body style="margin-left:100px">
        <a href="index.html">‚¨Ö voltar resum√£o</a>
        <h1>ü§ì RESUMO: Sistemas de arquivos üíª</h1>
        <p>Implementa√ß√£o (FAT, i-node)</p>
        <hr align="left" width="650px">
        
        <h2>Armazenamento da informa√ß√£o a longo prazo</h2>
        <ul>
            <li>Deve ser poss√≠vel armazenar uma quantidade muito grande de informa√ß√£o.</li>
            <li>A informa√ß√£o deve sobreviver ao t√©rmino do processo que a usa ‚Äì persist√™ncia.</li>
            <li>M√∫ltiplos processos devem ser capazes de acessar a informa√ß√£o concorrentemente ‚Äì compartilhamento.</li>
        </ul>

        <h2>Estrutura de arquivos</h2>
        <img src="images/estruturaArquivo.png" alt="estruturaArquivo">
        <ul>
            <li>sequ√™ncia de bytes;</li>
            <li>sequ√™ncia de registros;</li>
            <li>√°rvore.</li>
        </ul>

        <h2>Tipos de arquivos</h2>
        <ul>
            <li>Arquivo execut√°vel: cabe√ßalho: n√∫mero m√°gico, tamanho do c√≥digo, dos dados,
                dos segmentos de pilha e da tabela de s√≠mbolos, ponto de entrada. flags, c√≥digo,
                dados, bits de reloca√ß√£o, tabela de s√≠mbolos</li>
            <li>reposit√≥rio (archive/biblioteca de fun√ß√µes para serem usadas por programas):
                cabe√ßalho: nome do m√≥dulo, data, propriet√°rio, prote√ß√£o, tamanho. m√≥dulo-objeto.</li>
        </ul>

        <h2>Atributos (flags) de arquivos</h2>
        <p>Ex: arquivo somente de leitura, momento de cria√ß√£o, tamanho atual, ascii ou bin√°rio etc.</p>
        
        <h2>Acesso aos arquivos</h2>
        <ul>
            <li>Acesso sequencial: conveniente quando o meio era a fita magn√©tica.</li>
            <li>Acesso aleat√≥rio: essencial para sistemas de base de dados.</li>
        </ul>
        
        <h2>Opera√ß√µes com arquivos</h2>
        <p>Create, delete, opendir, closedir, readdir, rename, link, unlink.</p>
        
        <h2>Sistemas de diret√≥rios hier√°rquicos</h2>
        <img src="images/diretorios.png" alt="diretorios">
        <p>Diret√≥rios: servem para fazer a organiza√ß√£o de arquivos e de outros diret√≥rios, √© uma entidade
            l√≥gica que aponta pra outros diret√≥rios ou arquivos.</p>
        <p>Usualmente diret√≥rios s√£o implementados como arquivos especiais e seguem uma pol√≠tica de √°rvore.</p>
        
        <h2>Nomes de caminhos (pathnames)</h2>
        <p>Servem para acessar diretamente um diret√≥rio ou arquivo.</p>
        
        <h2>Opera√ß√µes com diret√≥rios</h2>
        <p>Create, delete, opendir, closedir, readdir, rename, link, unlink.</p>

        <h2>Implementa√ß√£o do sistema de arquivos</h2>
        <img src="images/implementacao1.png" alt="possivel layout de implementacao">
        <ul>
            <li>Master Boot Record (MBR);</li>
            <li>tabela de parti√ß√£o: divide o disco em parti√ß√µes l√≥gicas;</li>
            <li>bloco de boot: segunda parte do bootloader;</li>
            <li>superbloco: principais par√¢metros do sistema de arquivo. ex: tipo do sistema, n√∫mero de blocos;</li>
            <li>gerenciamento de espa√ßo livre;</li>
            <li>i-nodes: estrutura de dados com informa√ß√µes sobre um arquivo;</li>
            <li>diret√≥rio-raiz: diret√≥rio inicial;</li>
            <li>arquivos e diret√≥rios.</li>
        </ul>
        
        <h2>Implementa√ß√£o de arquivos (1)</h2>
        <img src="images/implementacao2.png" alt="implementacao2">
        <p>Aloca√ß√£o cont√≠gua: cada arquivo pra ser armazenado precisa ficar em blocos adjacentes
            e pra manipular o arquivo s√≥ precisa saber onde come√ßa o primeiro bloco.</p>
        <ul>
            <li>Vantagem: simples e r√°pida.</li>
            <li>Desvantagem: quando h√° remo√ß√£o voc√™ precisa juntar os blocos livres, ou vai "perder"
                aquele espa√ßo vazio entre blocos.</li>
        </ul>

        <h2>Implementa√ß√£o de arquivos (2)</h2>
        <img src="images/implementacao3.png" alt="implementacao3">
        <p>Armazenamento de um arquivo como uma lista encadeada: cada bloco do arquivo al√©m de conter
            os dados, ele cont√©m o endere√ßo do pr√≥ximo bloco</p>
        <ul>
            <li>Em disco: custo de ficar usando a unidade de armazenamento, porque precisa passar 
                por cada bloco anterior e requer acesso ao disco, que √© uma opera√ß√£o caracteres.</li>
            <li>Com tabela de aloca√ß√£o: a tabela vai ficar na mem√≥ria principal, base dos arquivo fat, muito mais eficiente</li>
        </ul>
        
        <h2>Implementa√ß√£o de arquivos (3)</h2>
        <img src="images/i-node.png" alt="i-nodes">
        <p>i-node: uma estrutura por aquivo, que cont√©m os atributos e os endere√ßos dos blocos do disco que o arquivo est√° adotando.
            O arquivo s√≥ precisa carregar essa estrutura. Tem uma quantidade de entrada fixas, mas as √∫ltimas posi√ß√µes apontam para
            blocos de disco com endere√ßos adicionais.</p>
        <ul>
            <li>Vantagem em rela√ß√£o as tabelas de aloca√ß√£o: se h√° um problema em uma uma estrutura, s√≥ esse arquivo ser√° afetado,
                diferentemente do que se houvesse um problema na tabela.</li>
            <li>Usado em sistemas operacionais baseados em unix.</li>
        </ul>
        <p>i-node em hierarquia: cada endere√ßo adicional aponta pra outro bloco que (tem dados do arquivo e) apontam pra outros blocos.</p>
        
        <h2>Implementa√ß√£o de diret√≥rios</h2>
        <img src="images/diretorios2.png" alt="diretorios2">
        <p>Diret√≥rios s√£o como uma tabela e cada entrada da tabela aponta para um arquivo ou outro diret√≥rio.</p>
        <ol type="a">
            <li>Um diret√≥rio simples: entradas de tamanho fixo, endere√ßos de disco e atributos na entrada do diret√≥rio.</li>
            <li>Diret√≥rio no qual cada entrada se refere apenas a um i-node.</li>
        </ol>

        <h2>Busca de um diret√≥rio no UNIX</h2>
        <img src="images/buscadiretorio.png" alt="buscadiretorio">

        <h2>Informa√ß√µes sobre um arquivo no MS-DOS</h2>
        <p>nome do arquivo, extens√£o, atributos, reservado, tempo, data, n√∫mero do primeiro bloco, tamanho.</p>

        <h2>Arquivos compartilhados (1)</h2>
        <img src="images/arqCompartilhado1.png" alt="arqCompartilhado1">
        <p>Cria√ß√£o de atalhos: dois diret√≥rios podem apontar pro mesmo arquivo sem ter uma c√≥pia.</p>
        <ul> 
            <li>Atalho simbolico: tem o caminho do arquivo que est√° apontando. se tirar o original, o atalho fica inv√°lido.</li>
            <li>Hard link: aponta direto pro i-node. se o arquivo original for removido, vai apontar pra um i-node invalido,
                se esse i-node for reutilizado pode acabar apontando pro arquivo errado.</li>
        </ul>

        <h2>Arquivos compartilhados (2)</h2>
        <img src="images/arqCompartilhado2.png" alt="arqCompartilhado2">
        <p>O i-node tem um contador que cont√©m a quantidade de diret√≥rios que est√£o apontando para o arquivo.
            enquanto o contador for >= 1 o arquivo n√£o ser√° realmente removido.</p>
        <p>Problema: o arquivo original vai ter espa√ßo ocupado por um arquivo que ele n√£o est√° mais usando.</p>

        <h2>Journaling</h2>
        <ul>
            <li>Lidar com falhas durante as opera√ß√µes em disco.</li>
            <li>Faz log antes das opera√ß√µes. Se o sistema quebrar, na recupera√ß√£o
                (ex: no boot), checa por opera√ß√µes inacabadas e conclui a opera√ß√£o</li>
            <li>As opera√ß√µes logadas precisam ser idempotentes. Ou seja, sua repeti√ß√£o n√£o vai causar nenhum preju√≠zo
                ao sistema de arquivos. ex: atualizar o mapa de bits para marcar bloco n como livre.</li>
        </ul>

        <h2>Sistemas de arquivos virtuais</h2>
        <p>Integra√ß√£o de v√°rios sistemas de arquivos em uma √∫nica estrutura.
            Os processos n√£o sabem da exist√™ncia das distintas implementa√ß√µes.</p>

        <h2>Gerenciamento do espa√ßo em disco</h2>
        <p>Considera√ß√µes relevantes:</p>
        <ul>
            <li>Tamanho do bloco: efici√™ncia.</li>
            <li>Monitoramento de blocos livres (ex: mapas de bits).</li>
        </ul>

        <h2>Tamanhos de arquivos</h2>
        <h2>Tamanhos de blocos e parti√ß√µes</h2>
        <h2>Gerenciamento de blocos livres</h2>
        <img src="images/gerBlocosLivres.png" alt="gerBlocosLivres">
    </body>
</html>